:root{
  --ii-page-bg: #ffffff;
  --ii-text: rgba(0,0,0,0.85);
  --ii-font: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

*{ box-sizing:border-box; }

html,body{
  height:100%;
  margin:0;
  font-family: var(--ii-font);
  background: var(--ii-page-bg);
}

.page{
  min-height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}

.ii{
  width:100%;
  background:#ffffff;
  padding: clamp(28px,4vw,52px) 0;
  overflow:hidden;
}

.ii__wrap{
  width:min(1200px,100%);
  margin:0 auto;
  padding:0 20px;
  min-height: min(860px, 100vh);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: clamp(18px,3vw,26px);
}

.ii__stage{
  width:100%;
  flex: 1 1 auto;
  min-height: clamp(420px,58vh,680px);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

.ii__stage-inner{
  width: min(var(--ii-max-w), 92vw);
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
  transform: translateZ(0);
}

.ii__img{
  display:block;
  width:100%;
  height:auto;
  user-select:none;
  -webkit-user-drag:none;
  pointer-events:none;
}

.ii__envelope{
  width:100%;
  position:relative;
  filter: drop-shadow(var(--ii-shadow));
  transform-origin: 50% 50%;
  will-change: transform, opacity;
  z-index: 6;
  transform: translateZ(0);
}

.ii__flip{
  width:100%;
  position:relative;
  aspect-ratio: 1 / 1;
  transform-style:preserve-3d;
  transition: transform 700ms cubic-bezier(.2,.8,.2,1);
}

.ii__flip-face{
  position:absolute;
  inset:0;
  backface-visibility:hidden;
  -webkit-backface-visibility:hidden;
}

.ii__flip-back{ transform: rotateY(180deg); }
.ii__envelope.is-flipped .ii__flip{ transform: rotateY(180deg); }

.ii__piece{
  position:absolute;
  inset:0;
  width:100%;
  height:auto;
  opacity:0;
  pointer-events:none;
  filter: drop-shadow(var(--ii-shadow-soft));
  transition: opacity 220ms ease;
}

.ii[data-state="back"] .ii__piece{ opacity: 1; }
.ii[data-state="opening"] .ii__piece{ opacity: 0; }

.ii[data-state="opening"] .ii__envelope{
  animation: iiEnvelopeExit 1400ms cubic-bezier(.2,.8,.2,1) forwards;
  pointer-events:none;
}

.ii[data-state="opening"] .ii__envelope.ii__envelope--behind{ z-index: 1; }

@keyframes iiEnvelopeExit{
  0%   { transform: translateX(0) rotate(0deg); opacity: 1; }
  38%  { transform: translateX(0) rotate(90deg); opacity: 1; }
  100% { transform: translateX(-46vw) rotate(90deg); opacity: 0; }
}

.ii__invite{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  z-index: 3;
}

.ii__invite-inner{
  width: min(var(--ii-max-w), 92vw);
  position:relative;
  opacity:0;
  transform: scale(0.92) translateZ(0);
  pointer-events:none;
  transition: opacity 520ms ease, transform 520ms cubic-bezier(.2,.8,.2,1);
  will-change: opacity, transform;
  z-index: 4;
}

.ii[data-state="opening"] .ii__invite-inner{
  opacity:1;
  transform: scale(var(--ii-invite-scale));
  pointer-events:auto;
  transition-delay: var(--ii-reveal-delay);
}

.ii[data-state="revealed"] .ii__invite-inner,
.ii[data-state="ready"] .ii__invite-inner{
  opacity:1;
  transform: scale(var(--ii-invite-scale));
  pointer-events:auto;
  transition-delay: 0ms;
}

.ii__invite-layer{
  position:absolute;
  left:0;
  bottom:0;
  width:100%;
  touch-action:none;
  will-change: transform;
}

.ii__invite-outer{
  z-index: 4;
  pointer-events:auto;
  filter: drop-shadow(var(--ii-shadow-layer));
}

.ii__invite-innercard{
  position:relative;
  width:100%;
  bottom:0;
  left:0;
  z-index: 3;
  pointer-events:auto;
  filter: drop-shadow(var(--ii-shadow-layer));
}

.ii__card{
  width:100%;
  position:relative;
  transform-style:preserve-3d;
  transition: transform 720ms cubic-bezier(.2,.8,.2,1);
}

.ii__card-face{
  position:absolute;
  inset:0;
  backface-visibility:hidden;
  -webkit-backface-visibility:hidden;
}

.ii__card-front{ position:relative; }
.ii__card-back{ transform: rotateY(180deg); }
.ii__invite-innercard.is-flipped .ii__card{ transform: rotateY(180deg); }

.ii__hint{
  position:absolute;
  z-index: 6;
  display:flex;
  align-items:center;
  gap: 10px;
  opacity:0;
  transform: translateY(8px) scale(0.98);
  pointer-events:none;
  transition: opacity 220ms ease, transform 220ms ease;
  left: calc(100% + 10px);
}

.ii[data-state="ready"] .ii__hint{
  opacity:1;
  transform: translateY(0) scale(1);
}

.ii__hint.is-hidden{
  opacity:0 !important;
  transform: translateY(10px) scale(0.98) !important;
}

.ii__hint-arrow{
  width: clamp(40px,5.2vw,58px);
  height:auto;
  display:block;
  animation: iiPulse 1.2s ease-in-out infinite;
  filter: drop-shadow(0 12px 24px rgba(0,0,0,0.10));
}

.ii__hint-arrow--drag{
  transform: scaleY(-1);
  animation: iiPulseDrag 1.2s ease-in-out infinite;
}

.ii__hint-text{
  font-size: clamp(18px,2.2vw,28px);
  font-weight: 500;
  color: var(--ii-text);
  animation: iiFloat 1.2s ease-in-out infinite;
  white-space: nowrap;
}

.ii__hint--tap{ top: 22%; }
.ii__hint--drag{ top: 50%; }

@keyframes iiPulse{
  0%{ transform: scale(1); opacity: 0.85; }
  50%{ transform: scale(1.06); opacity: 1; }
  100%{ transform: scale(1); opacity: 0.85; }
}

@keyframes iiPulseDrag{
  0%{ transform: scaleY(-1) scale(1); opacity: 0.85; }
  50%{ transform: scaleY(-1) scale(1.06); opacity: 1; }
  100%{ transform: scaleY(-1) scale(1); opacity: 0.85; }
}

@keyframes iiFloat{
  0%{ transform: translateY(0); }
  50%{ transform: translateY(-2px); }
  100%{ transform: translateY(0); }
}

.ii__controls{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: 14px;
  padding-bottom: clamp(16px,3vh,34px);
}

.ii__btn{
  appearance:none;
  border:0;
  cursor:pointer;
  background: var(--ii-btn-bg);
  color: var(--ii-btn-text);
  border-radius: var(--ii-radius);
  padding: 12px 30px;
  min-width: min(340px, 84vw);
  font-size: clamp(16px,2vw,22px);
  line-height:1;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  font-weight: 700;
  box-shadow: 0 18px 44px rgba(0,0,0,0.10);
  transition: transform 160ms ease, background 160ms ease, opacity 160ms ease;
  user-select:none;
  -webkit-tap-highlight-color: transparent;
}

.ii__btn:hover{ background: var(--ii-btn-bg-hover); transform: translateY(-1px); }
.ii__btn:active{ transform: translateY(0); opacity: 0.96; }

.ii__btn.is-disabled,
.ii__btn:disabled{
  cursor:not-allowed;
  background: var(--ii-btn-disabled-bg);
  color: var(--ii-btn-disabled-text);
  opacity: 0.92;
  transform: none;
}

.ii__restart{
  appearance:none;
  border:0;
  cursor:pointer;
  background: transparent;
  display:flex;
  align-items:center;
  justify-content:center;
  width: 56px;
  height: 56px;
  border-radius: 999px;
  box-shadow: 0 14px 34px rgba(0,0,0,0.10);
  transition: transform 160ms ease, opacity 160ms ease;
  user-select:none;
  -webkit-tap-highlight-color: transparent;
}

.ii__restart:hover{ transform: translateY(-1px); }
.ii__restart:active{ transform: translateY(0); opacity: 0.96; }

.ii__restart-icon{
  width: 34px;
  height: 34px;
  display:block;
  pointer-events:none;
  user-select:none;
  -webkit-user-drag:none;
  opacity: 0.92;
}

.ii[data-state="front"] .ii__invite-inner,
.ii[data-state="back"] .ii__invite-inner{
  opacity:0;
  transform: scale(0.92);
  pointer-events:none;
  transition-delay: 0ms;
}

.ii__debug-hide{ display:none !important; }

@media (max-width: 520px){
  .ii__hint{
    left: 50%;
    transform: translateX(-50%) translateY(8px) scale(0.98);
    gap: 8px;
  }
  .ii[data-state="ready"] .ii__hint{
    transform: translateX(-50%) translateY(0) scale(1);
  }
  .ii__hint--tap{ top: 8%; }
  .ii__hint--drag{ top: 34%; }
  .ii__hint-arrow{ width: 44px; }
  .ii__hint-text{ font-size: 18px; }
}

@media (max-width: 740px){
  .ii__wrap{ padding: 0 16px; }
  .ii__stage{ min-height: clamp(380px,56vh,620px); }
  .ii__btn{ min-width: min(320px, 90vw); }

  .ii[data-state="opening"] .ii__invite-inner,
  .ii[data-state="revealed"] .ii__invite-inner,
  .ii[data-state="ready"] .ii__invite-inner{
    transform: scale(var(--ii-invite-scale-mobile));
  }

  @keyframes iiEnvelopeExit{
    0%   { transform: translateX(0) rotate(0deg); opacity: 1; }
    40%  { transform: translateX(0) rotate(90deg); opacity: 1; }
    100% { transform: translateX(-60vw) rotate(90deg); opacity: 0; }
  }
}
